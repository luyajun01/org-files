simulexp <- function(N,lambda,rho,X,Beta)
{
  # covariate --> N Bernoulli trials
  #x <- sample(x=c(0, 1), size=N, replace=TRUE, prob=c(0.5, 0.5))
  # Weibull latent event times
  v<-runif(n=N)
  Tlat<-(-log(v)/(lambda*exp(X%*%Beta)))^(1/rho)
  # censoring times
  #C<-rexp(n=N,rate=rateC)
  C<-runif(n,min=quantile(Tlat,probs=0.06)/2,max=quantile(Tlat,probs=0.06)) #4%
  #C<-runif(n,min=quantile(Tlat,probs=0.11)/2,max=quantile(Tlat,probs=0.11)) #10：1%
  #C<-runif(n,min=quantile(Tlat,probs=0.20)/2,max=quantile(Tlat,probs=0.20)) #5：1%
  #C<-runif(n,min=quantile(Tlat,probs=0.75)/2,max=quantile(Tlat,probs=0.75)) #30%
  #C<-runif(n,min=quantile(Tlat,probs=0.545)/2,max=quantile(Tlat,probs=0.545)) #50%
  # follow-up times and event indicators
  time<-pmin(Tlat,C)
  status <-as.numeric(Tlat<=C)
  # data set
  data.frame(id=1:N,
             time=time,
             status=status,
             X=X)
}







